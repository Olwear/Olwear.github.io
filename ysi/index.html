<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ysi</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #f0f0f0;
        }
        
        .main {
            display: flex;
            justify-content: center;
        }
        
        .ibox {
            width: 320px;
            border: 2px solid #000;
        }
        
        .ibox .iwrap .iline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px;
            padding: 8px;
            border: 2px solid #000;
        }
        
        .ibox .iwrap input[type="text"] {
            width: 160px;
            font-size: 28px;
            background: transparent;
            border: 0;
            outline: none;
        }
        
        .injury {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 10px auto;
            color: #fff;
            background: #000;
            border-radius: 100%;
            opacity: .8;
            cursor: pointer;
        }
        
        .injury p {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<div class="ibox">
    <div class="iwrap">
        <div>
            <div class="iline">伤害倍率<input type="text" id="r" autocomplete="off"></div>
        </div>
        <div>
            <div class="iline">攻击力<input type="text" id="a" autocomplete="off"></div>
        </div>
        <div>
            <div class="iline">暴击伤害<input type="text" id="ca" autocomplete="off"></div>
        </div>
        <div>
            <div class="iline">伤害加成<input type="text" id="ia" autocomplete="off"></div>
        </div>
        <div class="iline">
            <input type="radio" name="er" id="er" value="0" checked>无</input>
            <input type="radio" name="er" id="er" value="0.5">1.5倍增幅</input>
            <input type="radio" name="er" id="er" value="1">2倍增幅</input>
        </div>
        <div>
            <div class="iline">元素精通加成<input type="text" id="ema" autocomplete="off"></div>
        </div>
        <div>
            <div class="iline">怪物抗性<input type="text" id="mr" autocomplete="off"></div>
        </div>
        <div>
            <div class="iline">角色等级<input type="text" id="clv" autocomplete="off"></div>
        </div>
        <div>
            <div class="iline">怪物等级<input type="text" id="mlv" autocomplete="off"></div>
        </div>
    </div>
    <div class="injury"></div>
</div>

<body>
    <script type="text/javascript">
        (function() {
            var dic = {};
            dic["r"] = 0; //技能倍率
            dic["a"] = 0; //攻击力
            dic["ca"] = 0; //暴击伤害
            dic["ia"] = 0; //伤害加成
            dic["er"] = 0; //元素反应
            dic["ema"] = 0; //元素精通加成
            dic["mr"] = 0; //怪物抗性
            dic["clv"] = 0; //角色等级
            dic["mlv"] = 0; //怪物等级
            var x = document.querySelectorAll(".iline input");
            for (var i in x) {
                x[i].oninput = function(e) {
                    e = e.target;
                    if (/^[0-9]{0,5}$/.test(e.value) || e.id == "er") {
                        dic[e.id] = parseFloat(e.value, 10);
                        ci();
                    } else {
                        dic[e.id] = 0;
                        e.value = "";
                    }
                };
            }

            function ci() {
                var injury = dic["r"] / 100 * dic["a"] * (1 + dic["ia"] / 100) * (1 - dic["mr"] / 100) * ((100 + dic["clv"]) / (200 + dic["clv"] + dic["mlv"])); //一般伤害
                //技能倍率 * 攻击力 * 伤害加成 * (1 - 怪物抗性) * ((100 + 角色等级) / (200 + 角色等级 + 怪物等级))
                injury = dic["ca"] ? injury * (1 + dic["ca"] / 100) : injury; //暴击
                injury = dic["er"] ? injury * ((1 + dic["er"]) + (1 + dic["ema"] / 100)) : injury; //元素反应
                injury = ~~injury; //最终伤害
                var o = document.querySelector(".injury");
                o.innerHTML = injury > 0 ? "<p>" + injury + "</p>" : "";
            }
        })();
    </script>
</body>

</html>
